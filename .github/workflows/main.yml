on: [push]

jobs: 
  publish:
    runs-on: ubuntu-latest
    name: Publish to JupiterOne
    steps:
    - name: LS
      run: pwd; ls .
    - name: Install Policy Builder
      run: npm install @jupiterone/security-policy-builder
    - name: publish
      env: 
        J1_ACCOUNT_ID: ${{ secrets.J1_ACCOUNT_ID }}
        J1_API_TOKEN: ${{ secrets.J1_API_TOKEN }}
      run: ./node_modules/@jupiterone/security-policy-builder/bin/psp publish -c config.json -t templates -a $J1_ACCOUNT_ID -k $J1_API_TOKEN -n
      